jenkins {
    jobs {
        "DBG_TESTSYSTEM_FRONTEND_DAILY_TEST" {
            dsl {
                description("""Do some checks against DBG games/pages (tipp24.com, mylotto24.ie, mylotto24.co.uk)<br />
				""")


                parameters {
                    stringParam 'TESTSYSTEM', 'app-daily02-dbg.test.t24.eu-west-1.sg-cloud.co.uk', "Test system URL (without 'http://', without trailing '/')"
                    booleanParam 'DBG_SMOKE', true, 'Open each DBG ticket, do some checks and submit ticket to basket'
                    booleanParam 'LC_SMOKE', false, 'Open LC lobby page, do some checks and submit ticket to basket'
                    booleanParam 'DBG_QUICKTIPPS', true, 'Test DBG ticket quicktipps'
                    booleanParam 'DBG_BASKET_QUICKTIPPS', true, 'Test DBG basket quicktipps'
                    booleanParam 'DBG_NUMBERS_AND_QUOTAS', false, 'Test DBG Numbers and quotas'

                }

                concurrentBuild true

                steps {


                    shell '''
					    mkdir -p $PWD/$BUILD_TAG
					    mkdir -p $PWD/$BUILD_TAG/test_run_results_html
					    mkdir -p $PWD/$BUILD_TAG/test_run_screenshots
                        export CONTAINER=devservices01.office.tipp24.de:5000/awint/autopylot
                        
						docker pull $CONTAINER


						if $DBG_SMOKE ; then
						  docker run -v $PWD/$BUILD_TAG:/usr/src/app/test_results --rm --shm-size=1g  $CONTAINER tests/dbg/live_monitoring/dbg_frontend_multitenant_smoketest.py --exec docker --host $TESTSYSTEM --jenkins $BUILD_URL --core $TESTSYSTEM  --browser chrome
						fi

                        if $LC_SMOKE ; then
                          docker run -v $PWD/$BUILD_TAG:/usr/src/app/test_results --rm --shm-size=1g  $CONTAINER tests/dbg/live_monitoring/dbg_frontend_lotteryclub_smoketest.py --exec docker --host $TESTSYSTEM --jenkins $BUILD_URL --core $TESTSYSTEM  --browser chrome
                        fi

						if $DBG_QUICKTIPPS ; then
						  docker run -v $PWD/$BUILD_TAG:/usr/src/app/test_results --rm --shm-size=1g  $CONTAINER tests/dbg/live_monitoring/dbg_frontend_multitenant_ticket_quicktipp.py --exec docker --host $TESTSYSTEM --jenkins $BUILD_URL --core $TESTSYSTEM  --browser chrome
						fi

						if $DBG_BASKET_QUICKTIPPS ; then
						  docker run -v $PWD/$BUILD_TAG:/usr/src/app/test_results --rm --shm-size=1g  $CONTAINER tests/dbg/live_monitoring/dbg_frontend_multitenant_basket_quicktipp.py  --exec docker --host $TESTSYSTEM --jenkins $BUILD_URL --core $TESTSYSTEM  --browser chrome
						fi
						
						if $DBG_NUMBERS_AND_QUOTAS ; then
                          docker run -v $PWD/$BUILD_TAG:/usr/src/app/test_results --rm --shm-size=1g  $CONTAINER tests/dbg/live_monitoring/dbg_frontend_multitenant_basket_quicktipp.py  --exec docker --host $TESTSYSTEM --jenkins $BUILD_URL --core $TESTSYSTEM  --browser chrome
                        fi
					'''
                }

                logRotator(5, 15)



                publishers {
                    archiveArtifacts('$BUILD_TAG/**/*')
                }

                wrappers {
                    colorizeOutput()
                    timestamps()
                }
            }
        }
    }
}
